# Story 1.3: PWA Polish & Branding

## **üìã Overview**
Complete the PWA implementation with proper branding, icons, screenshots, and all necessary assets to make "Apax KnowledgeNow 2025" a fully polished, installable Progressive Web App.

## **üéØ Goals**
- [ ] Update app branding to "Apax KnowledgeNow 2025"
- [ ] Create proper PWA icons (all required sizes)
- [ ] Add PWA screenshots for install UI
- [ ] Fix manifest warnings and improve installability
- [ ] Ensure PWA works perfectly on all devices
- [ ] Add proper app metadata and descriptions
- [ ] Implement data synchronization upon authentication

## **üì± PWA Requirements Checklist**

### **üè∑Ô∏è Branding Updates**
- [ ] **App Name**: "Apax KnowledgeNow 2025"
- [ ] **Short Name**: "KnowledgeNow 2025" (or "KN25")
- [ ] **Description**: Update to reflect Apax KnowledgeNow 2025 branding
- [ ] **Theme Colors**: Update to Apax brand colors
- [ ] **Background Colors**: Match Apax brand guidelines

### **üñºÔ∏è Icon Requirements**
- [x] **192x192 PNG** - Standard Android icon
- [x] **512x512 PNG** - High-res Android icon  
- [x] **180x180 PNG** - iOS home screen icon
- [x] **152x152 PNG** - iOS touch icon
- [x] **144x144 PNG** - Windows tile icon
- [x] **96x96 PNG** - Windows small tile
- [x] **72x72 PNG** - Windows medium tile
- [x] **SVG Icon** - Scalable vector icon
- [x] **Apple Touch Icon** - 180x180 for iOS
- [x] **Masked Icon** - For adaptive icons

### **üì∏ Screenshot Requirements**
- [x] **Mobile Screenshot** - 398x867 (iPhone format)
- [x] **Tablet Screenshot** - 768x1020 (iPad format)
- [x] **Desktop Screenshot** - 1005x670 (wide format)

### **üìÑ Manifest Improvements**
- [ ] **App ID**: Set proper ID field
- [ ] **Categories**: Add relevant app categories
- [ ] **Screenshots**: Add all required screenshots
- [ ] **Icons**: Include all icon sizes
- [ ] **Shortcuts**: Add app shortcuts (if applicable)
- [ ] **Related Applications**: Link to related apps (if any)

### **üîß Technical Improvements**
- [ ] **Service Worker**: Optimize caching strategies
- [ ] **Offline Page**: Improve offline experience
- [ ] **Custom Install Button**: Cross-platform install experience
- [ ] **iOS Safari Instructions**: Modal with step-by-step guide
- [ ] **Chrome/Edge Integration**: beforeinstallprompt API handling
- [ ] **Update Notifications**: Handle app updates
- [ ] **Push Notifications**: Setup (if needed)

## **üìä Data Synchronization Requirements**

### **üîÑ Authentication-Triggered Data Sync**
Upon successful user authentication, the app must automatically pull down all relevant data from the server to be used locally in the app.

### **üì• Data Synchronization Checklist**
- [ ] **Attendees Data**: Pull all attendee records for local use (should contain data)
- [ ] **Sponsors Data**: Pull all sponsor records for local use (should contain data)
- [ ] **Agenda Items**: Pull all agenda item records for local use (should contain data)
- [ ] **Seat Assignments**: Pull all seat assignment records for local use (should contain data)
- [ ] **Dining Options**: Pull all dining option records for local use (should contain data)
- [ ] **Hotels Data**: Pull all hotel records for local use (should contain data)
- [ ] **Seating Configurations**: Pull all seating configuration records for local use (should contain data)
- [ ] **User Profiles**: Pull all user profile records for local use (should contain data)

### **üíæ Local Storage Strategy**
- [ ] **IndexedDB Integration**: Store all data locally using IndexedDB
- [ ] **Cache Management**: Implement proper cache invalidation and updates
- [ ] **Offline Access**: Ensure all data is available when offline
- [ ] **Data Freshness**: Implement background sync for data updates
- [ ] **Storage Quotas**: Monitor and manage local storage usage

### **üîÑ Sync Process Implementation**
- [ ] **Authentication Hook**: Trigger data sync immediately after successful login
- [ ] **Progress Indicators**: Show sync progress to user during data download
- [ ] **Error Handling**: Handle network errors and retry failed syncs
- [ ] **Background Sync**: Implement periodic background data updates
- [ ] **Conflict Resolution**: Server is always the source of truth - when local data disagrees, use server data

### **üì± PWA Integration**
- [ ] **Service Worker Sync**: Use service worker for background data sync
- [ ] **Offline-First**: Ensure app works with locally cached data
- [ ] **Sync Status**: Display sync status in app UI
- [ ] **Manual Refresh**: Allow users to manually trigger data sync
- [ ] **Last Sync Time**: Show when data was last synchronized

## **üîç Database Schema Validation Requirements**

### **Schema Validation Strategy**
Since the database is still under construction, implement comprehensive schema validation to catch unexpected changes that could break data synchronization.

### **Schema Validation Checklist**
- [ ] **Table Existence**: Validate all expected tables exist
- [ ] **Column Structure**: Verify all required columns are present
- [ ] **Data Types**: Ensure column data types match expectations
- [ ] **Constraints**: Validate primary keys, foreign keys, and unique constraints
- [ ] **Indexes**: Check critical indexes for performance
- [ ] **Relationships**: Verify foreign key relationships are intact

### **Expected Tables Schema**
- [ ] **attendees**: id, name, email, company, role, etc.
- [ ] **sponsors**: id, name, logo_url, description, website, etc.
- [ ] **agenda_items**: id, title, description, start_time, end_time, location, etc.
- [ ] **seat_assignments**: id, attendee_id, seat_number, table_number, etc.
- [ ] **dining_options**: id, name, description, dietary_restrictions, etc.
- [ ] **hotels**: id, name, address, phone, website, etc.
- [ ] **seating_configurations**: id, name, layout_data, capacity, etc.
- [ ] **user_profiles**: id, user_id, preferences, settings, etc.

### **Schema Change Detection**
- [ ] **Automated Tests**: Run schema validation on every data sync
- [ ] **CI/CD Integration**: Fail builds if schema changes unexpectedly
- [ ] **Alerting**: Notify development team of schema changes
- [ ] **Graceful Degradation**: Handle schema changes with proper error messages
- [ ] **Migration Support**: Test compatibility with schema migrations

## **üé® Design Specifications**

### **Brand Colors**
- **Reference**: See `docs/ux/branding.md` for complete brand color specifications
- **Primary**: Purple `#9468CE` (Apax brand purple)
- **Secondary**: Ink/Navy `#0E1821` for body text
- **Background**: White `#FFFFFF` as primary surface
- **Accents**: Coral `#D9776F` (alerts), Lime `#7FB069` (success), Magenta `#A67DB8` (highlights)

### **Icon Design**
- **Style**: Modern, clean, professional
- **Elements**: Incorporate "KN" or "KnowledgeNow" branding
- **Colors**: Match Apax brand guidelines
- **Format**: Vector-based for scalability

### **Screenshot Requirements**
- **Quality**: High-resolution, clear
- **Content**: Show actual app functionality
- **Branding**: Include Apax KnowledgeNow 2025 branding
- **Devices**: Show on realistic device frames

## **üîß Custom Install Button Implementation**

### **Install Button Placement**
- **Home Screen**: Install button positioned under "View Full Schedule" section
- **Visibility**: Show only when PWA is not already installed
- **Security Note**: No install prompt on login page - users must be authenticated first for security reasons

### **Cross-Platform Install Button**
- **Chrome/Edge**: Use `beforeinstallprompt` API for native install prompt
- **iOS Safari**: Show modal with step-by-step instructions
- **Other Browsers**: Fallback to generic instructions
- **Detection**: Platform and browser detection logic
- **UI**: Custom button that appears when install is available

### **Technical Requirements**
- **beforeinstallprompt Event**: Listen for Chrome/Edge install prompt
- **iOS Detection**: Detect iPhone/iPad Safari specifically
- **Standalone Detection**: Hide button if already installed
- **Modal Instructions**: iOS-specific "Add to Home Screen" guide
- **Responsive Design**: Button works on all screen sizes

## **üìã Implementation Tasks**

### **Phase 1: Branding Updates**
1. Update app name in all files
2. Update manifest.json with new branding
3. Update package.json with new name
4. Update HTML title and meta tags
5. Update any hardcoded references

### **Phase 2: Icon Creation**
1. Design master icon in vector format
2. Generate all required PNG sizes
3. Create SVG version
4. Update manifest with all icons
5. Test icons on all platforms

### **Phase 3: Screenshot Creation**
1. Take screenshots of key app screens
2. Create device-framed versions
3. Add to manifest screenshots array
4. Test install UI with screenshots

### **Phase 4: Custom Install Button**
1. Implement custom PWA install button on home screen (under "View Full Schedule")
2. Add iOS Safari detection and instructions
3. Handle Chrome/Edge beforeinstallprompt API
4. Create cross-platform install experience
5. Test install button on all devices
6. **Security**: No install prompt on login page - authentication required first

### **Phase 5: Manifest Polish**
1. Add all required fields
2. Fix any warnings
3. Test installability criteria
4. Optimize for all platforms

### **Phase 6: Data Synchronization**
1. Implement authentication-triggered data sync
2. Set up IndexedDB for local data storage
3. Create sync progress indicators
4. Implement background sync with service worker
5. Add manual refresh and sync status UI

### **Phase 6.5: Database Schema Validation**
1. Create schema validation service to check table structure
2. Implement automated schema tests that run on data sync
3. Add schema change detection and alerting
4. Create migration compatibility tests
5. Set up CI/CD pipeline to catch schema changes early

### **Phase 7: Testing & Validation**
1. Test on Chrome desktop
2. Test on Chrome mobile
3. Test on Safari iOS
4. Test on Edge/Windows
5. Validate with PWA audit tools
6. Test offline functionality with local data
7. Validate data sync performance

## **üß™ Testing Checklist**

### **Installation Testing**
- [ ] Chrome desktop install prompt appears
- [ ] Chrome mobile install banner appears
- [ ] Safari iOS "Add to Home Screen" works
- [ ] Edge Windows install works
- [ ] App appears in app launcher

### **Offline Testing**
- [ ] App works offline after install
- [ ] Cached content loads properly
- [ ] Offline page shows when needed
- [ ] Service worker updates correctly

### **Icon Testing**
- [ ] Icons appear correctly in app launcher
- [ ] Icons scale properly on all devices
- [ ] No broken or missing icons
- [ ] Icons match brand guidelines

### **Screenshot Testing**
- [ ] Screenshots appear in install UI
- [ ] Screenshots show app functionality
- [ ] Screenshots are high quality
- [ ] Screenshots match device formats

### **Data Synchronization Testing**
- [ ] Data syncs automatically upon authentication
- [ ] All data tables are downloaded and stored locally
- [ ] App works offline with locally cached data
- [ ] Background sync updates data periodically
- [ ] Manual refresh triggers data sync
- [ ] Sync progress indicators work correctly
- [ ] Error handling works for failed syncs
- [ ] Data conflicts are resolved properly

### **Database Schema Validation Testing**
- [ ] **Schema Consistency Tests**: Validate all expected tables exist with correct structure
- [ ] **Column Validation**: Ensure all required columns are present and have correct data types
- [ ] **Relationship Tests**: Verify foreign key relationships are intact
- [ ] **Data Type Tests**: Validate column data types match expected schema
- [ ] **Index Validation**: Ensure critical indexes are present for performance
- [ ] **Schema Change Detection**: Automated tests that fail if schema changes unexpectedly
- [ ] **Migration Testing**: Test data sync works after any schema migrations
- [ ] **Backward Compatibility**: Ensure app handles schema changes gracefully

## **üìä Success Criteria**

### **PWA Audit Score**
- [ ] Lighthouse PWA score: 100/100
- [ ] All PWA criteria met
- [ ] No critical issues
- [ ] All warnings resolved

### **Installation Success**
- [ ] Install prompt appears within 30 seconds
- [ ] App installs successfully on all platforms
- [ ] App launches correctly after install
- [ ] App works offline after install

### **Brand Consistency**
- [ ] All branding updated to "Apax KnowledgeNow 2025"
- [ ] Colors match brand guidelines
- [ ] Icons are professional and branded
- [ ] Screenshots show proper branding

### **Data Synchronization Success**
- [ ] All data tables sync successfully upon authentication (should contain data)
- [ ] Local data storage works with IndexedDB
- [ ] App functions completely offline with cached data
- [ ] Background sync updates data without user intervention
- [ ] Sync performance is acceptable (< 30 seconds for full sync)
- [ ] Data integrity is maintained across sync operations
- [ ] Server remains source of truth for all data conflicts

### **Schema Validation Success**
- [ ] Schema validation tests pass for all expected tables
- [ ] Automated schema change detection works correctly
- [ ] CI/CD pipeline catches schema changes before deployment
- [ ] App handles schema changes gracefully with proper error messages
- [ ] Migration compatibility is tested and verified

## **üìÅ Files to Update**

### **Configuration Files**
- `vite.config.ts` - PWA configuration
- `package.json` - App name and metadata
- `public/manifest.webmanifest` - PWA manifest
- `public/index.html` - HTML meta tags

### **Asset Files**
- `public/icon-*.png` - All icon sizes
- `public/icon.svg` - Vector icon
- `public/apple-touch-icon.png` - iOS icon
- `public/masked-icon.svg` - Adaptive icon
- `public/screenshots/` - Screenshot directory

### **Source Files**
- `src/App.tsx` - App title and branding
- `src/components/` - Any hardcoded branding
- `src/services/pwaService.ts` - PWA service updates
- `src/services/dataSyncService.ts` - Data synchronization service
- `src/services/indexedDBService.ts` - Local data storage service
- `src/services/schemaValidationService.ts` - Database schema validation service
- `src/contexts/AuthContext.tsx` - Authentication-triggered sync
- `src/hooks/useDataSync.ts` - Data sync hook
- `src/__tests__/schemaValidation.test.ts` - Schema validation tests
- `src/__tests__/dataSync.test.ts` - Data synchronization tests

## **üöÄ Definition of Done**

- [ ] App name updated to "Apax KnowledgeNow 2025" everywhere
- [ ] All required PWA icons created and working
- [ ] Screenshots added and showing in install UI
- [ ] Manifest warnings resolved
- [ ] PWA installs successfully on all platforms
- [ ] Offline functionality works perfectly
- [ ] Lighthouse PWA score is 100/100
- [ ] All branding is consistent and professional
- [ ] Data synchronization works upon authentication
- [ ] All data tables are cached locally for offline use
- [ ] Background sync keeps data fresh
- [ ] App is ready for production deployment

## **üìù Notes**

- This story focuses on PWA polish and branding
- All icons should be created from a master vector design
- Screenshots should show actual app functionality
- Brand colors should match Apax guidelines
- Test on multiple devices and platforms
- Consider accessibility in icon design
- Data synchronization is critical for offline functionality
- Local data storage should be efficient and reliable
- Sync performance should be optimized for user experience

## **üîó Dependencies**

- **Story 1.1**: PWA Foundation (completed)
- **Story 1.2**: Supabase Integration (completed)
- **Design Assets**: Apax brand guidelines and colors
- **Icon Design**: Professional icon creation
- **Screenshot Tools**: Device frame mockups

---

**Priority**: High  
**Estimated Effort**: 2-3 days  
**Assigned To**: TBD  
**Status**: Ready to Start
